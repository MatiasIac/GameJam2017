<html>
    <body>
        <canvas id="canvas" width="640" height="480"></canvas>

        <script language="Javascript" src="framework/jsGFwk.js"></script>
        <script language="Javascript" src="framework/jsGFwk2dFastAnimation.js"></script>
        <script language="Javascript" src="framework/jsGFwkFonts.js"></script>
        <script language="Javascript" src="framework/jsGFwkIO.js"></script>
        <script language="Javascript" src="framework/jsGFwkCollisions.js"></script>
        <script language="Javascript" src="framework/jsGFwkContainer.js"></script>
        <script language="Javascript" src="framework/jsGFwkGamepad.js"></script>
        <script language="Javascript" src="framework/jsGFwkRM.js"></script>
	    <script language="Javascript" src="framework/jsGFwkSprites.js"></script>
        <script language="Javascript" src="framework/jsGFwkWebStorage.js"></script>
        <script language="Javascript" src="framework/jsGFwkScenes.js"></script>
        <script language="Javascript" src="framework/jsGFwkWebStorage.js"></script>
        <script language="Javascript" src="framework/jsGFwkGamepad.js"></script>
        <script language="Javascript" src="framework/jsGFwkUtils.js"></script>
        <script language="Javascript" src="framework/jsGFwkTimers.js"></script>
        <script language="Javascript" src="framework/alarm.js"></script>
        <script language="Javascript" src="curve.js"></script>
        <script language="Javascript" src="block.js"></script>
        <script language="Javascript" src="levelController.js"></script>
        <script language="Javascript" src="mapBuilder.js"></script>
        <script language="Javascript" src="foreground.js"></script>
        <script language="Javascript" src="background.js"></script>
        <script>

            jsGFwk.settings.canvas = "canvas";
            jsGFwk.settings.clearColor = "black";
            jsGFwk.settings.frameRate = 1000 / 60;

            jsGFwk.include("FastAnimation");
            jsGFwk.include("IO");
            jsGFwk.include("Collisions");
            jsGFwk.include("Gamepad");
            jsGFwk.include("ResourceManager");
    		jsGFwk.include("Sprites");
            jsGFwk.include("Fonts");
            jsGFwk.include("Storage");
            jsGFwk.include("Scenes");
            jsGFwk.include("Utils");

            jsGFwk.Fonts.createFont({ name: 'zxBold', source: 'zxBold.ttf' });

            var globalObjects = { };
            var splash = new Image();

            splash.onload = function () {
                jsGFwk.start();
            };
            splash.src = "images/intro.png";

            jsGFwk.ResourceManager.addGraphic({ name: "intro", source: "images/intro.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "map1", source: "images/map1.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "map2", source: "images/map2.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "map3", source: "images/map3.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "map4", source: "images/map4.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "foreground", source: "images/foreground.png" });
            jsGFwk.ResourceManager.addGraphic({ name: "background", source: "images/background.png" });
            jsGFwk.ResourceManager.addGraphic({	name: "ball", source: "ball/ball.png" });
            jsGFwk.ResourceManager.addGraphic({	name: "ball-die", source: "ball/ball-die.png" });
            jsGFwk.ResourceManager.addGraphic({	name: "blueball", source: "ball/blueball.png" });
            jsGFwk.ResourceManager.addGraphic({	name: "redball", source: "ball/redball.png" });

            jsGFwk.createObject({
                id: "progress",
                visible: true,
                barWidth: 0,
                init: function() {
                    jsGFwk.ResourceManager.onResourcesLoadedCompleted = function() {

                        globalObjects.blockContainer = jsGFwk.Container.createContainer('block', Block, true);

                        jsGFwk.Scenes.create({name: "game",
                            gameObjects: [Background,
                                          Curve,
                                          LevelController,
                                          Foreground,
                                          globalObjects.blockContainer] });

                        jsGFwk.Scenes.scenes.game.enable();
                        jsGFwk._gameObjects.progress.destroy();
                    };
                },
                update: function(delta) {
                },
                draw: function (context) {
                    context.drawImage(splash, 10, 10);
                    context.fillStyle = "white";
                    context.font = "11pt times";
                    context.fillText("Loading...", 250, 220);
                }
            });
        </script>
    </body>
</html>
